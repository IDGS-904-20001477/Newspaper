---
import { marked } from "marked";
import moment from "moment";
moment.locale("es");

const { post } = Astro.props;

const {
  featuredImage,
  title,
  content,
  author,
  readingTime,
  publishedAt,
  category,
} = post.attributes;
const url = import.meta.env.STRAPI_URL;

const authorImage = author.data.attributes.bioImage.data.attributes.url || null;
const postImage = featuredImage.data.attributes.url || null;
const publishedDate = moment(publishedAt, "YYYYMMDD").fromNow();
---

<section class="w-full h-72">
  <img
    src={postImage ? url + postImage : "https://via.placeholder.com/1080"}
    alt="Historia"
    class="w-full h-full object-cover z-0 blur-[2px]"
  />
</section>

<section
  class="pt-8 pb-16 lg:pt-16 lg:pb-24 bg-white dark:bg-gray-900 antialiased mx-4 md:mx-0"
>
  <div class="flex justify-center w-full mb-4">
    <div
      class="inline-flex mr-3 text-sm text-gray-900 dark:text-white w-full max-w-5xl"
    >
      <img
        class="mr-4 w-16 h-16 rounded-full"
        src={authorImage
          ? url + authorImage
          : "https://via.placeholder.com/1080"}
        alt="author picture"
      />
      <div>
        <a
          href="#"
          rel="author"
          class="text-xl font-bold text-gray-900 dark:text-white"
        >
          {author.data.attributes.name}
        </a>
        <p class="text-lg font-semibold text-gray-500 dark:text-gray-400">
          <time datetime={publishedDate} title={publishedDate}>
            {publishedDate}
          </time>
        </p>
        <p class="text-sm text-gray-500 dark:text-gray-400">
          {readingTime}
        </p>
      </div>
    </div>
  </div>

  <div class="flex justify-center w-full">
    <article
      class="w-full max-w-5xl prose lg:prose-xl format format-sm sm:format-base lg:format-lg format-blue dark:format-invert text-justify"
    >
      <header class="mb-4 lg:mb-6 not-format">
        <span
          class="bg-blue-200 text-blue-800 text-xs font-medium me-2 px-2.5 py-1.5 dark:bg-blue-900 dark:text-blue-300 rounded-full"
        >
          {category["data"]["attributes"]["Name"]}
        </span>
        <h1
          class="mb-4 text-3xl font-bold leading-tight text-gray-900 lg:mb-6 lg:text-4xl dark:text-white text-start"
        >
          {title}
        </h1>
      </header>
      <div set:html={marked.parse(content)} />

      <div class="w-full flex items-center justify-start">
        <div>
          <button
            type="button"
            class="text-white bg-[#1da1f2] hover:bg-[#1da1f2]/90 focus:ring-4 focus:outline-none focus:ring-[#1da1f2]/50 font-medium rounded-full text-sm px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#1da1f2]/55 me-2 mb-2"
            onclick="{ shareOnTwitter() }"
          >
            <i class="fa-brands fa-x-twitter"></i>&nbsp; Compartir en Twitter
          </button>
        </div>
      </div>
    </article>
  </div>
</section>

<aside
  aria-label="Related articles"
  class="py-8 lg:py-24 bg-gray-50 dark:bg-gray-800"
>
  <div class="px-4 mx-auto max-w-screen-xl">
    <h2 class="mb-8 text-2xl font-bold text-gray-900 dark:text-white">
      Related articles
    </h2>
    <div class="grid gap-12 sm:grid-cols-2 lg:grid-cols-4">
      <article class="max-w-xs">
        <a href="#">
          <img
            src="https://flowbite.s3.amazonaws.com/blocks/marketing-ui/article/blog-1.png"
            class="mb-5 rounded-lg"
            alt="Image 1"
          />
        </a>
        <h2
          class="mb-2 text-xl font-bold leading-tight text-gray-900 dark:text-white"
        >
          <a href="#">Our first office</a>
        </h2>
        <p class="mb-4 text-gray-500 dark:text-gray-400">
          Over the past year, Volosoft has undergone many changes! After months
          of preparation.
        </p>
        <a
          href="#"
          class="inline-flex items-center font-medium underline underline-offset-4 text-primary-600 dark:text-primary-500 hover:no-underline"
        >
          Read in 2 minutes
        </a>
      </article>
      <article class="max-w-xs">
        <a href="#">
          <img
            src="https://flowbite.s3.amazonaws.com/blocks/marketing-ui/article/blog-2.png"
            class="mb-5 rounded-lg"
            alt="Image 2"
          />
        </a>
        <h2
          class="mb-2 text-xl font-bold leading-tight text-gray-900 dark:text-white"
        >
          <a href="#">Enterprise design tips</a>
        </h2>
        <p class="mb-4 text-gray-500 dark:text-gray-400">
          Over the past year, Volosoft has undergone many changes! After months
          of preparation.
        </p>
        <a
          href="#"
          class="inline-flex items-center font-medium underline underline-offset-4 text-primary-600 dark:text-primary-500 hover:no-underline"
        >
          Read in 12 minutes
        </a>
      </article>
      <article class="max-w-xs">
        <a href="#">
          <img
            src="https://flowbite.s3.amazonaws.com/blocks/marketing-ui/article/blog-3.png"
            class="mb-5 rounded-lg"
            alt="Image 3"
          />
        </a>
        <h2
          class="mb-2 text-xl font-bold leading-tight text-gray-900 dark:text-white"
        >
          <a href="#">We partnered with Google</a>
        </h2>
        <p class="mb-4 text-gray-500 dark:text-gray-400">
          Over the past year, Volosoft has undergone many changes! After months
          of preparation.
        </p>
        <a
          href="#"
          class="inline-flex items-center font-medium underline underline-offset-4 text-primary-600 dark:text-primary-500 hover:no-underline"
        >
          Read in 8 minutes
        </a>
      </article>
      <article class="max-w-xs">
        <a href="#">
          <img
            src="https://flowbite.s3.amazonaws.com/blocks/marketing-ui/article/blog-4.png"
            class="mb-5 rounded-lg"
            alt="Image 4"
          />
        </a>
        <h2
          class="mb-2 text-xl font-bold leading-tight text-gray-900 dark:text-white"
        >
          <a href="#">Our first project with React</a>
        </h2>
        <p class="mb-4 text-gray-500 dark:text-gray-400">
          Over the past year, Volosoft has undergone many changes! After months
          of preparation.
        </p>
        <a
          href="#"
          class="inline-flex items-center font-medium underline underline-offset-4 text-primary-600 dark:text-primary-500 hover:no-underline"
        >
          Read in 4 minutes
        </a>
      </article>
    </div>
  </div>
</aside>
<script type="text/javascript">
const shareOnTwitter = () => {
  window.open(
    "https://twitter.com/intent/tweet?url=" +
    encodeURIComponent(window.location.href),
    "_blank",
    "width=600,height=300",
  );
};
</script>
